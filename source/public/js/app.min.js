function DialogController(e,t,n,r){e.showWelcome=!0;var i=this;e.isError=!1,firebase.auth().onAuthStateChanged(function(t){t&&(e.isError=!1)}),e.login=function(){var t=e.email,i=e.password;firebase.auth().signInWithEmailAndPassword(t,i).catch(function(t){e.isError=!0,e.errorCode=t.code;var n=t.message;console.log(t.code)}).then(function(){e.showWelcome=!0,n.hide(),r.path("/")})}}function registerController(e,t,n){e.colorado=".*@(colorado.edu)",e.createUser=function(){firebase.auth().createUserWithEmailAndPassword(e.newuser.email,e.newuser.password).catch(function(e){var t=e.code,n=e.message}).then(function(){alert=n.alert({title:"Welcome!",textContent:"You are officially registered! Please fill out the user profile and register your game profiles!",ok:"OK"}),n.show(alert),t.path("/profile")})}}function AvatarController(e,t,n){firebase.auth().onAuthStateChanged(function(r){r&&(e.update=function(){r.updateProfile({photoURL:e.imageUrl}).then(function(){t.hide(),n.location.reload()},function(e){console.log(e)})})})}function profileController(e,t,n){firebase.auth().onAuthStateChanged(function(r){if(r){r.photoURL||(e.userAvatar="https://pingendo.github.io/pingendo-bootstrap/assets/user_placeholder.png");var s=r.uid;e.options=["Freshman","Sophomore","Junior","Senior"],e.genders=["Male","Female","Other"],r.photoURL==null?e.userAvatar="https://pingendo.github.io/pingendo-bootstrap/assets/user_placeholder.png":e.userAvatar=r.photoURL,e.displayName=r.displayName,e.cu=!1,e.notCu=!1;var o;firebase.database().ref("users/"+s).on("value",function(t){o=t.val(),e.first=o.firstName,e.last=o.lastName,e.cuTrue=o.isCu,e.major=o.major,e.year=o.year,e.university=o.university,e.about=o.about,e.gender=o.gender,e.steamProfile=o.steamProfile,e.summoner=o.summoner,e.battleNet=o.battleNet},function(e){console.log(e)}),e.updateAvatar=function(e){t.show({controller:AvatarController,templateUrl:"templates/modal-avatar.html",clickOutsideToClose:!0})},e.save=function(){var t=[e.userAvatar,e.displayName,e.first,e.last,e.major,e.year,e.university,e.gender,e.steamProfile,e.summoner,e.battleNet,e.about];for(i=0;i<t.length;i++)t[i]==undefined&&t[i]==" ";r.updateProfile({displayName:t[1]}).then(function(){firebase.database().ref("users/"+s).update({photoURL:t[0],username:t[1],firstName:t[2],lastName:t[3],major:t[4],year:t[5],university:t[6],gender:t[7],steamProfile:t[8],summoner:t[9],battleNet:t[10],about:t[11]},function(){}),n.location.reload()})}}})}function playersController(e,t,n,r){e.$mdMedia=n,firebase.database().ref("users/").orderByChild("username").on("value",function(t){e.players=t.val()}),t(function(){e.loaded=!0},1e3),e.showPlayerInfo=function(e,t){r.show({controller:playerInfoController,templateUrl:"templates/modal-player.html",clickOutsideToClose:!0,targetEvent:t,locals:{user:e}})}}function playerInfoController(e,t){e.user=t,t.photoURL==null&&(e.user.photoURL="https://pingendo.github.io/pingendo-bootstrap/assets/user_placeholder.png")}function LeagueController(e,t,n){e.$mdMedia=n,e.positions=["Top","Mid","Bottom","Jungle","Support"],e.ranks=["Bronze","Silver","Gold","Platinum","Diamond","Challenger"],e.rankLevels=["I","II","III","IV","V"];var r=firebase.auth().currentUser.uid;firebase.database().ref("users/"+r+"/games/league").on("value",function(t){var n=t.val();e.primaryPosition=n.primary,e.secondaryPosition=n.secondary,e.rank=n.rank,e.rankLevel=n.rankLevel,e.experience=n.experience}),e.save=function(){firebase.auth().onAuthStateChanged(function(n){if(n){var r=n.uid;firebase.database().ref("users/"+r+"/games/league").set({isRegistered:1,primary:e.primaryPosition,secondary:e.secondaryPosition,rank:e.rank,rankLevel:e.rankLevel,experience:e.experience,teamCapitain:!0},function(){t.hide()})}})}}function DotaController(e,t,n){e.$mdMedia=n,e.positions=["Top","Mid","Bottom","Jungle","Support"],e.ranks=["0-400","400-800","800-1200","1200-1600","1600-2000","2000-2400","2400-2800","2800-3200","3200-3600","3600-4000","4000-4400","4400-4800","4800-5200","5200-5600","5600-6000","6000-6400","6400-6800","6800-7200","7200+"];var r=firebase.auth().currentUser.uid;firebase.database().ref("users/"+r+"/games/dota").on("value",function(t){var n=t.val();e.primaryPosition=n.primary,e.secondaryPosition=n.secondary,e.rank=n.rank,e.experience=n.experience}),e.save=function(){firebase.auth().onAuthStateChanged(function(n){if(n){var r=n.uid;firebase.database().ref("users/"+r+"/games/dota").set({isRegistered:1,primary:e.primaryPosition,secondary:e.secondaryPosition,rank:e.rank,experience:e.experience,teamCapitain:!0},function(){t.hide()})}})}}function CSGOController(e,t,n){e.$mdMedia=n,e.positions=["AWPer","Rifler","Entry","Lurker"],e.ranks=["Silver I","Silver II","Silver III","Silver IV","Silver Elite","Silver Elite Master","Gold Nova I","Gold Nova II","Gold Nova III","Gold Nova Master","Master Guardian I","Master Guardian II","Master Guardian Elite","Distinguished Master Guardian","Legendary Eagle","Legendary Eagle Master","Supreme Master First Class","The Global Elite"];var r=firebase.auth().currentUser.uid;firebase.database().ref("users/"+r+"/games/csgo").on("value",function(t){var n=t.val();e.primaryPosition=n.primary,e.secondaryPosition=n.secondary,e.rank=n.rank,e.experience=n.experience}),e.save=function(){firebase.auth().onAuthStateChanged(function(n){if(n){var r=n.uid;firebase.database().ref("users/"+r+"/games/csgo").set({isRegistered:1,primary:e.primaryPosition,secondary:e.secondaryPosition,rank:e.rank,experience:e.experience,teamCapitain:!0},function(){t.hide()})}})}}function OverwatchController(e,t,n){e.$mdMedia=n,e.positions=["Attack","Defense","Tank","Support"],e.ranks=["0-9","10-19","20-29","30-39","40-49","50-59","60-69","70-79","80-89","90-99","100+"];var r=firebase.auth().currentUser.uid;firebase.database().ref("users/"+r+"/games/overwatch").on("value",function(t){var n=t.val();e.primaryPosition=n.primary,e.secondaryPosition=n.secondary,e.rank=n.rank,e.experience=n.experience}),e.save=function(){firebase.auth().onAuthStateChanged(function(n){if(n){var r=n.uid;firebase.database().ref("users/"+r+"/games/overwatch").set({isRegistered:1,primary:e.primaryPosition,secondary:e.secondaryPosition,rank:e.rank,experience:e.experience,teamCapitain:!0},function(){t.hide()})}})}}function teamController(e){firebase.database().ref("teams/CounterStrikeGlobalOffensive").on("value",function(t){e.csgoTeams=t.val()},function(e){console.log(e)}),firebase.database().ref("teams/Dota2").on("value",function(t){e.dotaTeams=t.val()}),firebase.database().ref("teams/LeagueofLegends").on("value",function(t){e.leagueTeams=t.val()}),firebase.database().ref("teams/Overwatch").on("value",function(t){e.overwatchTeams=t.val()}),e.buttonText="Request to Join Team",e.request=function(t){var n=firebase.auth().currentUser.displayName,r=firebase.auth().currentUser.uid,i=t.game.replace(/\s/g,""),s={};firebase.database().ref("users/"+t.captain+"/notifications/requests/"+i+"/"+r).on("value",function(i){s=i.val(),firebase.database().ref("users/"+t.captain+"/notifications/requests/"+t.game+"/"+r).set({username:n,uid:r,requested:!0,pending:!0,game:t.game})})}}function teamLogoController(e,t){firebase.auth().onAuthStateChanged(function(n){if(n){var r=n.uid;e.update=function(){firebase.database().ref("users/"+r+"/teams/temp").set({teamLogo:e.imageUrl},function(){t.hide()})}}else t.hide()})}function createTeamController(e,t,n){firebase.database().ref("users").on("value",function(t){e.users=t.val()}),e.loaded=!0,e.team={},e.gameList=["League of Legends","Dota 2","Counter Strike Global Offensive","Overwatch"],e.tiers=["Tier 1","Tier 2","Tier 3"],e.team.logoUrl="http://placehold.it/150x150",e.createTeam=function(){firebase.auth().onAuthStateChanged(function(t){if(t){e.team.captain=t.uid;var r=t.uid,i=e.team.game;i=i.replace(/\s/g,""),firebase.database().ref("users/"+r+"/teams/"+i).set(e.team),firebase.database().ref("teams/"+i+"/"+r).set(e.team),console.log("Team Created!"),n.path("/my-teams")}})};var r=function(e){n.path(e)}}function myTeamController(e,t,n){e.teams=[];var r=firebase.auth().currentUser.uid;firebase.database().ref("users/"+r+"/teams").on("value",function(t){teamData=t.val(),teamData?(teamData.CounterStrikeGlobalOffensive&&e.teams.push(teamData.CounterStrikeGlobalOffensive),teamData.Overwatch&&e.teams.push(teamData.Overwatch),teamData.Dota2&&e.teams.push(teamData.Dota2),teamData.LeagueofLegends&&e.teams.push(teamData.LeagueofLegends)):console.log("nothing to see here")},function(e){console.log(e)})}function reportBugController(e){e.success=0,e.submit=function(t){if(t)if(t.email&&t.data){var n=new Date;t.time=n.getTime(),firebase.database().ref("dev/bug_reports").push(t),console.log("Success"),e.success=1}else console.log("empty inputs");else console.log("empty fields")}}function officialTeamsController(e){}(function(){var e=angular.module("esports",["ngRoute","ngMaterial","firebase"]);e.config(function(e,t,n){e.when("/",{templateUrl:"templates/home.html",controller:"mainController"}).when("/marketplace",{templateUrl:"templates/marketplace.html"}).when("/events",{templateUrl:"templates/events.html"}).when("/players",{templateUrl:"templates/players.html",controller:playersController}).when("/register",{templateUrl:"templates/register.html",controller:registerController}).when("/profile",{templateUrl:"templates/profile.html",controller:profileController}).when("/official-teams",{templateUrl:"templates/official-teams.html",controller:officialTeamsController}).when("/my-teams",{templateUrl:"templates/my-teams.html",controller:myTeamController}).when("/teams",{templateUrl:"templates/teams.html",controller:teamController}).when("/create-team",{templateUrl:"templates/create-team.html",controller:createTeamController}).when("/report-bug",{templateUrl:"templates/report.html",controller:reportBugController}),t.html5Mode(!0)}).config(function(e){e.theme("default").accentPalette("blue")}).controller("mainController",function(e,t,n,r,i,s,o){e.$mdMedia=s,e.loaded=!1,e.$on("$viewContentLoaded",function(){i(function(){e.loaded=!0},1e3)}),e.toggleRight=function(){n("right").toggle()},e.redirect=function(e){o.location.href=e},firebase.auth().onAuthStateChanged(function(t){if(t){e.showRequest=1;var n=t.uid;e.notifications={},firebase.database().ref("users/"+n+"/notifications").on("value",function(t){e.notifications=t.val()}),e.deny=function(e){},e.approve=function(e){var t=e.game.replace(/\s/g,""),r=[];firebase.database().ref("users/"+n+"/teams/"+t+"/players").once("value").then(function(i){i.val()?(r=i.val(),r.push(e.username),console.log(r),firebase.database().ref("users/"+n+"/teams/"+t).update({players:r}),firebase.database().ref("teams/"+t+"/"+n).update({players:r})):(r.push(e.username),console.log(r),firebase.database().ref("users/"+n+"/teams/"+t).update({players:r}),firebase.database().ref("teams/"+t+"/"+n).update({players:r}))}),console.log(e.game),firebase.database().ref("users/"+n+"/notifications/requests/"+"{{requestData.game}}"+e.uid).remove()}}})}).controller("RightCtrl",function(e,t,n,r){e.close=function(){n("right").toggle()}}).controller("LeftCtrl",function(e,t,n,r,i){e.close=function(){n("left").toggle()}}).controller("TwitchCtrl",function(e,t,n){}).controller("menuController",function(e,t){e.redirect=function(e){t.path(e)}}).controller("loginController",function(e,t,n,r,i,s){firebase.auth().onAuthStateChanged(function(t){t?e.isUser=!0:e.isUser=!1}),e.showModal=function(e){t.show({controller:DialogController,templateUrl:"templates/modal-login.html",targetEvent:e,clickOutsideToClose:!0})},e.logout=function(){firebase.auth().signOut().then(function(){r.path("/")},function(e){console.log(e)})},e.closeSideNav=function(){s("left").toggle()},e.redirect=function(){r.path("/profile")}}).controller("userController",function(e,t,n){e.closeSideNav=function(){n("left").toggle()},e.current_user={},firebase.auth().onAuthStateChanged(function(t){t?(t.photoURL===null?e.current_user.avatar="https://pingendo.github.io/pingendo-bootstrap/assets/user_placeholder.png":e.current_user.avatar=t.photoURL,e.current_user.displayName=t.displayName):(e.current_user.avatar="https://pingendo.github.io/pingendo-bootstrap/assets/user_placeholder.png",e.current_user.displayName=null)})}).controller("gameRegisterController",function(e,t){e.showModal=function(e){e==="league"?t.show({controller:LeagueController,templateUrl:"templates/modal-league.html",clickOutsideToClose:!0}):e==="dota"?t.show({controller:DotaController,templateUrl:"templates/modal-dota.html",clickOutsideToClose:!0}):e==="csgo"?t.show({controller:CSGOController,templateUrl:"templates/modal-csgo.html",clickOutsideToClose:!0}):e==="overwatch"&&t.show({controller:OverwatchController,templateUrl:"templates/modal-overwatch.html",clickOutsideToClose:!0})}}).controller("myTeamCardController",function(e,t,n){var r=firebase.auth().currentUser.uid;e.saveTeam=function(e){alert=t.alert({title:"Save Team",textContent:"Saving Team "+e.name,ok:"SAVE"}),t.show(alert).finally(function(){alert=undefined,game=e.game.replace(/\s/g,""),firebase.database().ref("users/"+r+"/teams/"+game).update({name:e.name,logoUrl:e.logoUrl,members:e.members,email:e.email}),firebase.database().ref("teams/"+game+"/"+r).update({name:e.name,logoUrl:e.logoUrl,members:e.members,email:e.email}),n.reload()})},e.deleteTeam=function(e){alert=t.alert({title:"Delete Team",textContent:"This team will be deleted.",ok:"OK"}),t.show(alert).finally(function(){alert=undefined,game=e.game.replace(/\s/g,""),firebase.database().ref("users/"+r+"/teams/"+game).remove(),firebase.database().ref("teams/"+game+"/"+r).remove(),console.log("deleted team"),n.reload()})}}).factory("User",function(e){var t;return firebase.database().ref("users/"+uid).on("value",function(e){t=e.val()}),t}).factory("Auth",function(e,t){var n=firebase.auth().currentUser;return firebase.auth().onAuthStateChanged(function(e){if(e)return e}),n}).constant("FirebaseUrl","https://esports-dev.firebaseio.com/")})();